/*! Minty v1.0.0 | by shingchi <shingchi@sina.cn> (https://github.com/shingchi) | Licensed under MIT | 2014-12-17 */ 
!function(e,t,a){{var n,s=[],o=".minty",r=minty.apiUrl;minty.swfUrl}soundManager.setup({html5PollingInterval:50,flashVersion:9}),soundManager.onready(function(){e(o).each(function(){s.push(new n(e(this)))})}),n=function(t,n){function s(){C=e.extend({},I,n)}function o(){var e,a,n;e=t.find(C.selecter.controls),a=t.find(C.selecter.playlist),n=e.find(C.selecter.progress),v={player:t,controls:e,playlist:a,progress:n,progressLoaded:n.find(C.selecter.progressLoaded),progressPlayed:n.find(C.selecter.progressPlayed),duration:e.find(C.selecter.duration),detail:e.find(C.selecter.detail),button:{play:e.find(C.selecter.button.play),volume:e.find(C.selecter.button.volume),menu:e.find(C.selecter.button.menu)}}}function l(){function t(){return C.data.sources}function n(e){var n;return null===C.data.selectedIndex?e:(n=t(),e=e!==a?e:C.data.selectedIndex,source=n[e])}function s(){var e,t=C.data.sources.length;return null!==C.data.selectedIndex&&C.data.selectedIndex++,t>1?C.data.selectedIndex>=t?C.data.loop?(e=n(0),C.data.selectedIndex=0):(e=n(C.data.selectedIndex),C.data.selectedIndex--):e=n(C.data.selectedIndex):C.data.loop?(e=n(0),C.data.selectedIndex=0):(e=n(C.data.selectedIndex),C.data.selectedIndex=0),e}function o(){return C.data.selectedIndex--,C.data.selectedIndex<0&&(C.data.loop?C.data.selectedIndex=C.data.sources.length-1:C.data.selectedIndex++),n()}function r(){var t,a="."+C.css.selected;null!==C.data.sources&&(t=v.playitem.filter(a)),t&&t.each(function(){e(this).removeClass(C.css.selected)})}function l(t){var n;r(),(t!==a||null!==t)&&(n=v.playitem[t],e(n).addClass(C.css.selected)),C.data.selectedIndex=t}function d(){var e,t;return e=n(),e&&(t=e.src),t}return{getNext:s,getPrevious:o,getSource:n,getURL:d,select:l}}function d(e){var t=Math.floor(e/1e3),a=Math.floor(t/60),n=Math.floor(t%60);return(10>a?"0":"")+a+":"+(10>n?"0":"")+n}function i(e){var t;t=C.data.sources,v.detail.html(t[e].title+" - "+t[e].author)}function u(){var e=C.data.sources.length;e>1&&v.playlist.addClass(C.css.menu)}function c(e){var t=soundManager.createSound({url:e,whileplaying:function(){var e;e=Math.min(100,Math.max(0,100*this.position/this.durationEstimate))+"%",this.duration&&(v.progressPlayed.css("width",e),v.duration.html("-"+d(this.duration-this.position)))},onbufferchange:function(e){e?v.player.addClass("buffering"):v.player.removeClass("buffering")},onplay:function(){v.button.play.removeClass("paused").addClass("playing")},onpause:function(){v.button.play.removeClass("playing").addClass("paused")},onresume:function(){v.button.play.removeClass("paused").addClass("playing")},whileloading:function(){var e=this.bytesLoaded/this.bytesTotal*100+"%";v.progressLoaded.css("width",e),this.isHTML5||v.duration.html(d(this.durationEstimate))},onload:function(e){e?v.duration.html(d(this.duration)):this._iO&&this._iO.onerror&&this._iO.onerror()},onerror:function(){var e;e=h.getSource(),e&&v.detail.html("错误: 当前歌曲无法播放"),v.button.play.removeClass("playing").addClass("paused")},onstop:function(){v.button.play.removeClass("playing")},onfinish:function(){var e;v.button.play.removeClass("playing"),v.progressPlayed.css("width",0),v.duration.html("--:--"),e=h.getNext(),h.select(C.data.selectedIndex),i(C.data.selectedIndex),e&&this.play({url:e.src})}});return t}function p(e){var t=C.data.sources[e];soundManager.canPlayURL(t.src)&&(x||(x=c(t.src)),x.stop(),h.select(e),i(e),x.play({url:t.src,position:0}))}function f(){if(C.data.type=v.player.data("type"),C.data.id=v.player.data("songs"),v.player.data("auto")!==a&&(C.data.auto=v.player.data("auto")),v.player.data("loop")!==a&&(C.data.loop=v.player.data("loop")),e.ajax({url:r,dataType:"json",async:!1,data:{"do":C.data.type,id:C.data.id},success:function(e){C.data.sources=e},error:function(){console.error("无法获取媒体信息")}}),C.data.sources&&C.data.sources.length>0){for(var t=0;t<C.data.sources.length;t++){var n=C.data.sources[t].title,s=C.data.sources[t].author,o='<li data-index="'+t+'">'+n+" - "+s+"</li>";v.playlist.append(o)}v.playitem=v.playlist.children()}}function y(){t||console.warn("init(): No playerNode element?"),s(),o(),f(),h=new l,h.select(0),C.data.auto&&p(0),i(0),u(),b.add(v.player.get(0),"click",g),b.add(v.progress.get(0),"click",m)}function g(t){var a,n,s,o,r,l;if(a=t||window.event,n=a.target||a.srcElement,n&&n.nodeName&&(s=n.nodeName.toLowerCase(),"li"===s&&(o=e(n).data("index"),r=C.data.sources[o].src,C.data.selectedIndex===o?(x||(x=c(r)),x.togglePause()):soundManager.canPlayURL(r)&&p(o),l=!0),"i"===s)){var d=C.selecter.button.play.replace(".",""),i=C.selecter.button.volume.replace(".",""),u=C.selecter.button.menu.replace(".",""),f=e(n).attr("class").toString();f.indexOf(d)>=0&&(o=C.data.selectedIndex,r=C.data.sources[o].src,x||(x=c(r)),h.select(o),x.togglePause(),l=!0),f.indexOf(i)>=0&&(x&&(x.toggleMute(),v.button.volume.toggleClass(C.css.mute)),l=!0),f.indexOf(u)>=0&&(v.playlist.toggleClass(C.css.menu),l=!0)}return l?void 0:!1}function m(e){function t(e){var t=0;if(e.offsetParent)for(;e.offsetParent;)t+=e.offsetLeft,e=e.offsetParent;else e.x&&(t+=e.x);return t}var a,n,s,o,r,l;return a=v.progress.get(0),n=t(a),s=a.offsetWidth,o=e.clientX-n,r=o/s,l=x,l&&l.duration&&(l.setPosition(l.duration*r),l._iO.whileplaying.apply(l)),!1}var v,h,x,b,I,C;I={selecter:{controls:".minty-controls",detail:".minty-detail",playlist:".minty-playlist",progress:".minty-progress",progressLoaded:".minty-progress-loaded",progressPlayed:".minty-progress-played",duration:".minty-duration",button:{play:".minty-button-play",volume:".minty-button-volume",menu:".minty-button-menu"}},css:{disabled:"disabled",selected:"selected",active:"active",mute:"mute",menu:"open"},data:{type:null,id:null,loop:!0,auto:!0,selectedIndex:0,sources:null}},b={add:function(e,t,a){var n={detach:function(){return remove(e,t,a)}};return window.addEventListener?e.addEventListener(t,a,!1):e.attachEvent("on"+t,a),n},remove:window.removeEventListener!==a?function(e,t,a){return e.removeEventListener(t,a,!1)}:function(e,t,a){return e.detachEvent("on"+t,a)},preventDefault:function(e){return e.preventDefault?e.preventDefault():(e.returnValue=!1,e.cancelBubble=!0),!1}},y()}}(jQuery,this);